<?xml version="1.0" encoding="utf-8"?>
<Package xmlns="http://schemas.microsoft.com/appx/manifest/foundation/windows10"
         xmlns:uap="http://schemas.microsoft.com/appx/manifest/uap/windows10"
         xmlns:uap3="http://schemas.microsoft.com/appx/manifest/uap/windows10/3"
         xmlns:rescap="http://schemas.microsoft.com/appx/manifest/foundation/windows10/restrictedcapabilities"
         IgnorableNamespaces="uap uap3 rescap">

  <!--
    Identity:
    - Name: Unique identifier (reverse-domain style, no spaces)
    - Publisher: Must EXACTLY match your signing certificate subject
      SignPath will replace this during signing with your cert's CN
    - Version: Must be 4-part (Major.Minor.Build.Revision)
  -->
  <Identity Name="${IDENTITY_NAME}"
            Publisher="CN=${PUBLISHER_DISPLAY_NAME}"
            Version="${VERSION}"
            ProcessorArchitecture="x64" />

  <Properties>
    <DisplayName>Neovide Tabs</DisplayName>
    <PublisherDisplayName>${PUBLISHER_DISPLAY_NAME}</PublisherDisplayName>
    <Description>A tabbed interface for managing multiple Neovide instances</Description>
    <Logo>Assets\StoreLogo.png</Logo>
  </Properties>

  <!--
    Dependencies:
    - TargetDeviceFamily: Minimum Windows 10 version (1809 = build 17763)
    - MaxVersionTested: Tested up to Windows 11
  -->
  <Dependencies>
    <TargetDeviceFamily Name="Windows.Desktop"
                        MinVersion="10.0.17763.0"
                        MaxVersionTested="10.0.22621.0" />
  </Dependencies>

  <Resources>
    <Resource Language="en-us"/>
  </Resources>

  <Applications>
    <!--
      Application:
      - Id: Internal identifier (alphanumeric, no spaces)
      - Executable: Must match your binary name exactly
      - EntryPoint: "Windows.FullTrustApplication" for Win32 apps
    -->
    <Application Id="NeovideTabs"
                 Executable="neovide-tabs.exe"
                 EntryPoint="Windows.FullTrustApplication">

      <uap:VisualElements
          DisplayName="Neovide Tabs"
          Description="Tabbed interface for Neovide"
          Square150x150Logo="Assets\Square150x150Logo.png"
          Square44x44Logo="Assets\Square44x44Logo.png"
          BackgroundColor="transparent">

        <uap:DefaultTile Wide310x150Logo="Assets\Wide310x150Logo.png"
                         Square71x71Logo="Assets\Square44x44Logo.png"
                         Square310x310Logo="Assets\Square310x310Logo.png">
          <uap:ShowNameOnTiles>
            <uap:ShowOn Tile="square150x150Logo"/>
            <uap:ShowOn Tile="wide310x150Logo"/>
            <uap:ShowOn Tile="square310x310Logo"/>
          </uap:ShowNameOnTiles>
        </uap:DefaultTile>

        <uap:SplashScreen Image="Assets\Square150x150Logo.png" BackgroundColor="#1a1b26"/>

      </uap:VisualElements>

    </Application>
  </Applications>

  <!--
    Capabilities:
    - runFullTrust: Required for Win32 desktop apps packaged as MSIX
      This grants the app the same permissions as a traditional Win32 app
    
    Security note: runFullTrust means the app can:
    - Access the full filesystem (with user consent where applicable)
    - Run child processes (needed for spawning Neovide)
    - Register global hotkeys
    - Access Windows APIs without sandbox restrictions
    
    This is necessary for neovide-tabs functionality but means users
    should only install from trusted sources (signed releases).
  -->
  <Capabilities>
    <rescap:Capability Name="runFullTrust" />
  </Capabilities>

</Package>
